{"ast":null,"code":"import _regeneratorRuntime from\"/Users/oceane/Documents/Sites/clone-twitch/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/oceane/Documents/Sites/clone-twitch/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/oceane/Documents/Sites/clone-twitch/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useParams}from'react-router-dom';import Axios from'axios';import Config from'../Config';import{Link}from'react-router-dom';var GameStreams=function GameStreams(){var _useParams=useParams(),slug=_useParams.slug;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),streamData=_useState2[0],setStreamData=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),viewers=_useState4[0],setViewers=_useState4[1];var oToken=sessionStorage.getItem('theToken');useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var fetchIdGame,idGame,result,dataArray,finalArray,totalViewers,userIDs,baseUrl,queryParamsUsers,finalUrl,getUsersLogin,userLoginArray;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Axios.create({headers:{'Client-ID':Config.clientID,'Authorization':'Bearer '+oToken}}).get(\"https://api.twitch.tv/helix/games?name=\".concat(slug));case 2:fetchIdGame=_context.sent;// console.log(fetchIdGame);\nidGame=fetchIdGame.data.data[0].id;// console.log(idGame);\n_context.next=6;return Axios.create({headers:{'Client-ID':Config.clientID,'Authorization':'Bearer '+oToken}}).get(\"https://api.twitch.tv/helix/streams?game_id=\".concat(idGame));case 6:result=_context.sent;// console.log(result);\ndataArray=result.data.data;finalArray=dataArray.map(function(stream){var newURL=stream.thumbnail_url.replace('{width}','320').replace('{height}','180');stream.thumbnail_url=newURL;return stream;});//Calcul du total des viewers\n//La méthode reduce() applique une fonction qui est un « accumulateur » et qui traite chaque valeur d'une liste (de la gauche vers la droite) afin de la réduire à une seule valeur.\ntotalViewers=finalArray.reduce(function(acc,val){return acc+val.viewer_count;},0);userIDs=dataArray.map(function(stream){return stream.user_id;});baseUrl=\"https://api.twitch.tv/helix/users?\";queryParamsUsers=\"\";userIDs.map(function(id){return queryParamsUsers=queryParamsUsers+\"id=\".concat(id,\"&\");});finalUrl=baseUrl+queryParamsUsers;_context.next=17;return Axios.create({headers:{'Client-ID':Config.clientID,'Authorization':'Bearer '+oToken}}).get(finalUrl);case 17:getUsersLogin=_context.sent;userLoginArray=getUsersLogin.data.data;finalArray=dataArray.map(function(stream){stream.login=\"\";userLoginArray.forEach(function(login){if(stream.user_id===login.id){stream.login=login.login;}});return stream;});setViewers(totalViewers);setStreamData(finalArray);case 22:case\"end\":return _context.stop();}}},_callee);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[slug,oToken]);console.log(streamData);return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h1\",{className:\"titreGamesStreams\"},\"Stream : \",slug),/*#__PURE__*/React.createElement(\"h3\",{className:\"sousTitreGameStreams\"},/*#__PURE__*/React.createElement(\"strong\",{className:\"textColored\"},viewers),\" personnes regardent \",slug),/*#__PURE__*/React.createElement(\"div\",{className:\"flexAccueil\"},streamData.map(function(stream,index){return/*#__PURE__*/React.createElement(\"div\",{key:index,className:\"carteGameStreams\"},/*#__PURE__*/React.createElement(\"img\",{src:stream.thumbnail_url,alt:\"jeu carte\",className:\"imgCarte\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"cardBodyGameStreams\"},/*#__PURE__*/React.createElement(\"h5\",{className:\"titreCartesStream\"},stream.user_name),/*#__PURE__*/React.createElement(\"p\",{className:\"txtStream\"},\"Nombre de viewers : \",stream.viewer_count),/*#__PURE__*/React.createElement(Link,{className:\"lien\",to:{pathname:\"/live/\".concat(stream.login)}},/*#__PURE__*/React.createElement(\"div\",{className:\"btnCarte\"},\"Regarder \",stream.user_name))));})));};export default GameStreams;","map":{"version":3,"sources":["/Users/oceane/Documents/Sites/clone-twitch/frontend/src/components/GameStreams/index.js"],"names":["React","useState","useEffect","useParams","Axios","Config","Link","GameStreams","slug","streamData","setStreamData","viewers","setViewers","oToken","sessionStorage","getItem","fetchData","create","headers","clientID","get","fetchIdGame","idGame","data","id","result","dataArray","finalArray","map","stream","newURL","thumbnail_url","replace","totalViewers","reduce","acc","val","viewer_count","userIDs","user_id","baseUrl","queryParamsUsers","finalUrl","getUsersLogin","userLoginArray","login","forEach","console","log","index","user_name","pathname"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams } from 'react-router-dom';\nimport Axios from 'axios';\nimport Config from '../Config';\nimport { Link } from 'react-router-dom';\n\nconst GameStreams = () => {\n\n    let {slug} = useParams();\n\n    const [streamData, setStreamData] = useState([]);\n    const [viewers, setViewers] = useState(0);\n\n    const oToken = sessionStorage.getItem('theToken');\n\n    useEffect(() => {\n    const fetchData = async () => {\n        const fetchIdGame = await Axios.create({\n            headers: {\n                'Client-ID' : Config.clientID,\n                'Authorization' : 'Bearer ' + oToken\n            }\n        }).get(`https://api.twitch.tv/helix/games?name=${slug}`);\n\n        // console.log(fetchIdGame);\n\n        let idGame = fetchIdGame.data.data[0].id;\n\n        // console.log(idGame);\n\n        const result = await Axios.create({\n        headers: {\n            'Client-ID' : Config.clientID,\n            'Authorization' : 'Bearer ' + oToken\n        }\n        }).get(`https://api.twitch.tv/helix/streams?game_id=${idGame}`);\n        // console.log(result);\n\n        let dataArray = result.data.data;\n\n        let finalArray = dataArray.map(stream => {\n            let newURL = stream.thumbnail_url\n            .replace('{width}', '320')\n            .replace('{height}', '180');\n            stream.thumbnail_url = newURL;\n            return stream;\n        })\n\n        //Calcul du total des viewers\n\n        //La méthode reduce() applique une fonction qui est un « accumulateur » et qui traite chaque valeur d'une liste (de la gauche vers la droite) afin de la réduire à une seule valeur.\n        let totalViewers = finalArray.reduce((acc, val) => {\n            return acc + val.viewer_count;\n        }, 0)\n\n        let userIDs = dataArray.map(stream => {\n            return stream.user_id\n        })\n\n        let baseUrl = \"https://api.twitch.tv/helix/users?\";\n        let queryParamsUsers = \"\";\n\n        userIDs.map(id => {\n            return (queryParamsUsers = queryParamsUsers + `id=${id}&`)\n        });\n        let finalUrl = baseUrl + queryParamsUsers;\n\n        let getUsersLogin = await Axios.create({\n        headers: {\n            'Client-ID' : Config.clientID,\n            'Authorization' : 'Bearer ' + oToken\n        }\n        }).get(finalUrl);\n\n        let userLoginArray = getUsersLogin.data.data;\n\n        finalArray = dataArray.map(stream => {\n            stream.login = \"\";\n\n            userLoginArray.forEach(login => {\n            if(stream.user_id === login.id) {\n            stream.login = login.login\n            }\n            })\n\n            return stream;\n        })\n\n        setViewers(totalViewers);\n        setStreamData(finalArray);\n    }\n\n    fetchData();\n\n    }, [slug, oToken])\n\n    console.log(streamData);\n    return(\n        <div>\n            <h1 className=\"titreGamesStreams\">Stream : {slug}</h1>\n            <h3 className=\"sousTitreGameStreams\">\n                <strong className=\"textColored\">{viewers}</strong> personnes regardent {slug}\n            </h3>\n\n            <div className=\"flexAccueil\">\n                {streamData.map((stream, index) => ( \n                    <div key={index} className=\"carteGameStreams\">\n                        <img src={stream.thumbnail_url} alt=\"jeu carte\" className=\"imgCarte\"/>\n                        <div className=\"cardBodyGameStreams\">\n                            <h5 className=\"titreCartesStream\">{stream.user_name}</h5>\n                            <p className=\"txtStream\">Nombre de viewers : {stream.viewer_count}</p>\n\n                            <Link\n                            className=\"lien\"\n                            to={{\n                                pathname: `/live/${stream.login}`\n                            }}>\n                                <div className=\"btnCarte\">Regarder {stream.user_name}</div>\n                            </Link>\n                        </div>\n                    </div>\n                ))}\n            </div>\n        </div>\n    )\n}\n\nexport default GameStreams;"]},"metadata":{},"sourceType":"module"}